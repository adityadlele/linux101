
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lecture 1 &#8212; Practical Molecular simulations</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script >const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lecture 2" href="lecture2.html" />
    <link rel="prev" title="Molecular dynamics basics" href="md_basics.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Practical Molecular simulations</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Practical Molecular Simulations
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="prereq.html">
   Prerequisites
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="access.html">
     How to get access to Princeton compueter clusters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="terminal.html">
     How to use the computing cluster
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="tools.html">
     Simulation Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lammps.html">
     LAMMPS Tutorial 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="md_basics.html">
   Molecular dynamics basics
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Lecture 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture2.html">
     Lecture 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture3.html">
     Lecture 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture4.html">
     Lecture 4
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="LAMMPS.html">
   LAMMPS
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture5.html">
     Lecture 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture6.html">
     Lecture 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Advanced_techniques.html">
   Advanced techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture7.html">
     Lecture 7
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture8.html">
     Lecture 8
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="DFT.html">
   DFT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture9.html">
     Lecture 9
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="lecture10.html">
     Lecture 10
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="Exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ex0.html">
     Exercise 0
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ex1.html">
     Exercise 1
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/lecture1.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/lecture1.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/lecture1.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#molecular-dynamics-simulations">
   Molecular dynamics simulations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-an-interatomic-potential">
   What is an interatomic potential?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-j-potential">
     L-J potential
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anatomy-of-a-md-code">
   Anatomy of a MD code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#md-pseudo-code">
     MD pseudo-code
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization">
     Initialization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#force-calculation">
     Force calculation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equations-of-motion">
     Equations of motion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-md-run">
   The MD run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-lammps-run">
   Sample LAMMPS run
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Lecture 1</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#molecular-dynamics-simulations">
   Molecular dynamics simulations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-is-an-interatomic-potential">
   What is an interatomic potential?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-j-potential">
     L-J potential
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anatomy-of-a-md-code">
   Anatomy of a MD code
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#md-pseudo-code">
     MD pseudo-code
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialization">
     Initialization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#force-calculation">
     Force calculation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#equations-of-motion">
     Equations of motion
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-md-run">
   The MD run
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sample-lammps-run">
   Sample LAMMPS run
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="section" id="lecture-1">
<h1>Lecture 1<a class="headerlink" href="#lecture-1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="molecular-dynamics-simulations">
<h2>Molecular dynamics simulations<a class="headerlink" href="#molecular-dynamics-simulations" title="Permalink to this headline">¶</a></h2>
<p>Molecular dynamics simulations typically refer to computer simulations of molecular motion. We are mainly going to discuss classical reactive molecular
dynamics in this class. The classical part of this name refers to empirical potentials that drive the motion of atoms using Newtons classical laws of
motion. These empirical potentials can either describe non-reactive or reactive processes governed by molecular motion. We are largely going to stick to
reactive molecular dynamics simulations, specifically ReaxFF potential.</p>
<p>Chemical reactive events are ubiquitous in nature. These events govern many aspects of our lives, from energy generating combustion reactions to
metabolism. These events span several thermodynamic and time scales. Computationally studying and modeling these reaction events is a major asset
in our quest to understand the world that we live in. A variety of methods, ranging from the quantum chemistry studies of reactions to continuum
scale simulations of reactive processes, are available to study reaction chemistry. The first principle or quantum chemistry (QC) methods delve into
the atomic world, describing electronic structures and associated useful properties used to characterize a reaction event. However, these methods
become computationally untenable for the scale of several hundreds of atoms even with the best current computational resources. On the other end of
size spectrum are continuum scale computational fluid dynamics simulations (CFD). These can simulate much larger scale processes such as the combustion
in an automobile engine [1], which involves fluid mechanics as well as reactions chemistry processes. However, the CFD simulations typically involve
only a simplified description of reactive events in the form of lumped or abbreviated reaction mechanisms.</p>
<p>Reactive force field methods bridge the gap between the first principle and CFD methods. These methods deploy connection-dependent interatomic
potentials to calculate system energy as a function of atomic positions. In the ReaxFF reactive force field method, the interatomic potential describes
reactive events through a bond-order formalism, where bond order is empirically calculated from interatomic distances. The interatomic potentials
are trained using the QC data. Electronic interactions driving chemical bonding are treated implicitly, allowing the method to simulate reaction
chemistry without explicit QC consideration. This puts ReaxFF in a unique position to simulate reaction dynamics of systems involving thousands of
molecules while approaching the accuracy of the QC methods.</p>
</div>
<div class="section" id="what-is-an-interatomic-potential">
<h2>What is an interatomic potential?<a class="headerlink" href="#what-is-an-interatomic-potential" title="Permalink to this headline">¶</a></h2>
<p>To understand the atomic motion, we first need to understand the forces and energies between these atoms. Imagine a car driving on a straight road.
The position of the car as a function of time can be determined using Newtons laws of motion. However, to determine the velocity or acceleration
of the vehicle, we also need to calculate the energy produced by the engine as a function of time. This energy would be a function of fuel intake,
wind resistance and several other factors. Similarly, a molecular dynamics potential defines the energy of the system as a function of interatomic
distances and configurations. These interatomic potential are the driving engines of the molecular dynamics simulations.</p>
<p>The form of the interatomic potential depends on the application it has been developed for. Let us consider the example of an inert gas. Assume that
we want to model the motion of an inert gas and derive useful properties such as its density as a function of temperature and pressure. Given that
it is an inert gas, the energy change in the system would mainly originate from the atoms moving close and away from each other. There are not
reactions happening among the molecules. If we don’t want to simulate high temperatures where the atoms break apart forming plasma, we would need
an expression describing energy of a system of two atoms as a function of interatomic distance. The following section reviews one such potential.</p>
<div class="section" id="l-j-potential">
<h3>L-J potential<a class="headerlink" href="#l-j-potential" title="Permalink to this headline">¶</a></h3>
<p>The LJ potential is defined as</p>
<div class="math notranslate nohighlight">
\[
V(r)=4\epsilon\left[\left(\frac{\sigma}{r}\right)^{12}-\left(\frac{\sigma}{r}\right)^{6}\right]
\]</div>
<p>Let us plot the LJ potential first</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Boltzmann&#39;s constant, J/K</span>
<span class="n">kB</span> <span class="o">=</span> <span class="mf">1.381e-23</span>

<span class="c1"># The Lennard-Jones parameters:</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">1.024e-23</span>   <span class="c1"># J.nm^6</span>
<span class="n">B</span> <span class="o">=</span> <span class="mf">1.582e-26</span>   <span class="c1"># J.nm^12</span>

<span class="c1"># Adjust the units of A and B - they have more manageable values</span>
<span class="c1"># in K.nm^6 and K.nm^12</span>
<span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">/</span> <span class="n">kB</span><span class="p">,</span> <span class="n">B</span> <span class="o">/</span> <span class="n">kB</span>

<span class="c1"># Interatomic distance, in nm</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="c1"># Interatomic potential</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">12</span> <span class="o">-</span> <span class="n">A</span><span class="o">/</span><span class="n">r</span><span class="o">**</span><span class="mi">6</span>
<span class="c1"># Interatomic force</span>
<span class="c1">#F = Put your formula</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;U(r)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="lj-fig" style="width: 300px">
<div class="cell_output docutils container">
<img alt="_images/lecture1_6_0.png" src="_images/lecture1_6_0.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">L-J potential for Ar gas.</span><a class="headerlink" href="#lj-fig" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="anatomy-of-a-md-code">
<h2>Anatomy of a MD code<a class="headerlink" href="#anatomy-of-a-md-code" title="Permalink to this headline">¶</a></h2>
<p>So how do we model the motion of the molecules using the interatomic potential. This task is performed by numerous MD codes (such as LAMMPS),
most of which have following aspects as a part of them. The codes typically start by initiating positions and velocities for the particles based
on user defined directives. These properties are then used to determine interatomic forces between the particles. The forces,positions and
velocities are then used to solve Newton’s equations of motion numerically. The numerical equation detrmines the updated positions of the particles
after a small but finite time (time-step). The old and new positions can then be used to detrmine the new velocities. This cycle is continued for
multiple time-steps until the desired properties are obtained. On top this basic structure, MD simulation codes also have ways to impose thermodynamic
conditions on the simulated system through thermostats and barostats, which we will discuss later. What is also clear from this description is that
all the properties of interest need to be a function of position and velocities of the particles.</p>
<div class="figure align-default" id="directive-fig">
<a class="reference internal image-reference" href="_images/MD_structure.png"><img alt="_images/MD_structure.png" src="_images/MD_structure.png" style="height: 300px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Simplified structure of a typical MD code.</span><a class="headerlink" href="#directive-fig" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="md-pseudo-code">
<h3>MD pseudo-code<a class="headerlink" href="#md-pseudo-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1">#Intialize the code</span>
intialize the code
<span class="nv">t</span><span class="o">=</span><span class="m">0</span>
<span class="c1">#MD loop</span>

<span class="k">do</span> loop <span class="k">while</span> <span class="o">(</span><span class="nv">t</span><span class="o">=</span><span class="m">0</span> to <span class="nv">t</span><span class="o">=</span>t<span class="nv">$_</span><span class="o">{</span>max<span class="o">}</span>$<span class="o">)</span>
	<span class="c1">#Calculate forces</span>
	cal forces<span class="o">(</span>xyz, <span class="nv">t</span><span class="o">=</span>t<span class="nv">$_n</span>$<span class="o">)</span>
	<span class="c1">#Calculate equations of motion</span>
	cal motion<span class="o">(</span>xyz, <span class="nv">t</span><span class="o">=</span>t<span class="nv">$_n</span>$<span class="o">)</span>
	<span class="nv">t</span><span class="o">=</span>t+dt
	<span class="c1"># Calculate properties</span>
	cal property<span class="o">(</span>xyz, <span class="nv">t</span><span class="o">=</span>t<span class="nv">$_n</span>$<span class="o">)</span>
end loop
end
</pre></div>
</div>
</div>
<div class="section" id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> intialization
<span class="k">do</span> from <span class="nv">i</span><span class="o">=</span><span class="m">0</span> to <span class="nv">i</span><span class="o">=</span>no. of particles
	xyz<span class="o">(</span>i<span class="o">)=</span>position of particle i
	v<span class="o">(</span>i<span class="o">)=</span>rand_vel
	ke<span class="o">(</span>i<span class="o">)=</span><span class="m">0</span>.5*mass*v<span class="o">(</span>i<span class="o">)</span>**2
end loop
</pre></div>
</div>
</div>
<div class="section" id="force-calculation">
<h3>Force calculation<a class="headerlink" href="#force-calculation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> force_and_energy_calculation
<span class="k">do</span> from <span class="nv">i</span><span class="o">=</span><span class="m">0</span> to <span class="nv">i</span><span class="o">=</span>no. of particles
	f<span class="o">(</span>i<span class="o">)=</span><span class="m">0</span> <span class="c1">#initialize forces to 0</span>
end loop

<span class="k">do</span> from <span class="nv">i</span><span class="o">=</span><span class="m">0</span> to <span class="nv">i</span><span class="o">=</span>no. of particles
	<span class="k">do</span> from <span class="nv">j</span><span class="o">=</span><span class="m">0</span> to <span class="nv">j</span><span class="o">=</span>no. of particles
		<span class="nv">xr</span><span class="o">=</span>x<span class="o">(</span>i<span class="o">)</span>-x<span class="o">(</span>j<span class="o">)</span>
		<span class="k">if</span> xr is less than cutoff
		  <span class="nv">force</span><span class="o">=</span>force_equation<span class="o">(</span>e.g. LJ force equation<span class="o">)</span>
		  <span class="nv">updated_force</span><span class="o">=</span>f<span class="o">(</span>i<span class="o">)</span>+force
		  <span class="nv">updated_energy</span><span class="o">=</span>energy_equation
		end <span class="k">if</span> condition
	end loop
end loop
</pre></div>
</div>
</div>
<div class="section" id="equations-of-motion">
<h3>Equations of motion<a class="headerlink" href="#equations-of-motion" title="Permalink to this headline">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="k">function</span> integrate equations of motion

<span class="k">do</span> from <span class="nv">i</span><span class="o">=</span><span class="m">0</span> to <span class="nv">i</span><span class="o">=</span>no. of particles
	<span class="nv">xx</span><span class="o">=</span><span class="m">2</span>*x<span class="o">(</span>i<span class="o">)</span>-xm<span class="o">(</span>i<span class="o">)</span>+dt^2*2f<span class="o">(</span>i<span class="o">)</span> <span class="c1">#verlet algorithm</span>
	v<span class="o">(</span>i<span class="o">)=(</span>xx-xm<span class="o">(</span>i<span class="o">))</span>/<span class="o">(</span>2dt<span class="o">)</span> <span class="c1">#new velocity</span>
	xm<span class="o">(</span>i<span class="o">)=</span>x<span class="o">(</span>i<span class="o">)</span> <span class="c1">#undate positions</span>
end loop
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-md-run">
<h2>The MD run<a class="headerlink" href="#the-md-run" title="Permalink to this headline">¶</a></h2>
<p>Let us take a look at an example of a LJ potential to model the motion of an inert gas. You will be
able to play with the following code as a part of excersize for this lecture. The code uses ASE to
simulate Ar liquid at 94.4 K using LJ potential.</p>
<blockquote>
<div><p>This example has a historical significance. Aneesur Rahman, considered as one of the pioneers of
molecular dynamics, used similar methods modelling motion of atoms in liquid Argon. This paper is
generally considered to mark the beginnings of the molecular dynamics method. You can access the
original paper <a class="reference external" href="https://journals.aps.org/pr/abstract/10.1103/PhysRev.136.A405">here</a>.</p>
</div></blockquote>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>from ase import Atoms, units
from ase.visualize import view
from ase.calculators.lj import LennardJones
from ase.md.velocitydistribution import MaxwellBoltzmannDistribution
from ase.md.verlet import VelocityVerlet
from ase.md.langevin import Langevin
from ase.md.nptberendsen import NPTBerendsen 
from ase.io.trajectory import Trajectory
from ase.optimize.minimahopping import MinimaHopping
from ase_notebook import AseView, ViewConfig, get_example_atoms
from ase.io import read, write, lammpsrun
from ase import units 
import numpy as np
import matplotlib.pyplot as plt
from ase.visualize import view
</pre></div>
</div>
<p>Let us first define the simulation box geometry.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">config</span> <span class="o">=</span> ViewConfig<span class="o">()</span>
<span class="nv">ase_view</span> <span class="o">=</span> AseView<span class="o">(</span>config<span class="o">)</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nv">atoms</span><span class="o">=</span>read<span class="o">(</span><span class="s1">&#39;/home/al9001/Ar.xyz&#39;</span><span class="o">)</span>
</pre></div>
</div>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>view<span class="o">(</span>atoms, <span class="nv">viewer</span><span class="o">=</span><span class="s1">&#39;x3d&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>Run a sample MD simulation.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>%%time
atoms.calc <span class="o">=</span> LennardJones<span class="o">(</span><span class="nv">sigma</span><span class="o">=</span><span class="m">0</span>.34,epsilon<span class="o">=</span><span class="m">1</span>.657E-21,rc<span class="o">=</span><span class="m">3</span>.4<span class="o">)</span>
MaxwellBoltzmannDistribution<span class="o">(</span>atoms, <span class="nv">temperature_K</span><span class="o">=</span><span class="m">95</span><span class="o">)</span>
<span class="c1">#T = 94.4  # Kelvin</span>

<span class="nv">dyn</span> <span class="o">=</span> NPTBerendsen<span class="o">(</span>atoms, <span class="nv">timestep</span><span class="o">=</span><span class="m">0</span>.1 * units.fs, <span class="nv">temperature_K</span><span class="o">=</span><span class="m">95</span>,
                   <span class="nv">taut</span><span class="o">=</span><span class="m">100</span> * units.fs, <span class="nv">pressure_au</span><span class="o">=</span><span class="m">1</span>.01325 * units.bar,
                   <span class="nv">taup</span><span class="o">=</span><span class="m">1000</span> * units.fs, <span class="nv">compressibility</span><span class="o">=</span><span class="m">4</span>.57e-5 / units.bar<span class="o">)</span>

def printenergy<span class="o">(</span><span class="nv">a</span><span class="o">=</span>atoms<span class="o">)</span>:  <span class="c1"># store a reference to atoms in the definition.</span>
    <span class="s2">&quot;&quot;&quot;Function to print the potential, kinetic and total energy.&quot;&quot;&quot;</span>
    <span class="nv">epot</span> <span class="o">=</span> a.get_potential_energy<span class="o">()</span> / len<span class="o">(</span>a<span class="o">)</span>
    <span class="nv">ekin</span> <span class="o">=</span> a.get_kinetic_energy<span class="o">()</span> / len<span class="o">(</span>a<span class="o">)</span>
    print<span class="o">(</span><span class="s1">&#39;Energy per atom: Epot = %.3feV  Ekin = %.2feV (T=%3.0fK)  &#39;</span>
          <span class="s1">&#39;Etot = %.3feV&#39;</span> % <span class="o">(</span>epot, ekin, ekin / <span class="o">(</span><span class="m">1</span>.5 * units.kB<span class="o">)</span>, epot + ekin<span class="o">))</span>


dyn.attach<span class="o">(</span>printenergy, <span class="nv">interval</span><span class="o">=</span><span class="m">50</span><span class="o">)</span>

<span class="c1"># We also want to save the positions of all atoms after every 100th time step.</span>
<span class="nv">traj</span> <span class="o">=</span> Trajectory<span class="o">(</span><span class="s1">&#39;moldyn3.traj&#39;</span>, <span class="s1">&#39;w&#39;</span>, atoms<span class="o">)</span>
dyn.attach<span class="o">(</span>traj.write, <span class="nv">interval</span><span class="o">=</span><span class="m">50</span><span class="o">)</span>

<span class="c1"># Now run the dynamics</span>
printenergy<span class="o">()</span>
dyn.run<span class="o">(</span><span class="m">200</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="sample-lammps-run">
<h2>Sample LAMMPS run<a class="headerlink" href="#sample-lammps-run" title="Permalink to this headline">¶</a></h2>
<p>Let us run the same simulation with LAMMPS and compare the results.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>units           real
atom_style      atomic


read_data       ar.data

velocity        all create <span class="m">1</span>.0 <span class="m">87287</span>

pair_style      lj/cut <span class="m">2</span>.5
pair_coeff      <span class="m">1</span> <span class="m">1</span> <span class="m">1</span>.0 <span class="m">1</span>.0 <span class="m">2</span>.5

neighbor        <span class="m">0</span>.3 bin
neigh_modify    every <span class="m">20</span> delay <span class="m">0</span> check no

fix             <span class="m">1</span> all npt temp <span class="m">95</span>.0 <span class="m">95</span>.0 <span class="m">100</span>.0 iso <span class="m">1</span>.0 <span class="m">1</span>.0 <span class="m">1000</span>.0




timestep        <span class="m">0</span>.25

thermo          <span class="m">100</span>
thermo_style    custom step pe ke etotal temp press vol density
thermo_modify   format float %15.14g

dump             <span class="m">1</span> all custom <span class="m">500</span> dump.ar id <span class="nb">type</span> x y z

run             <span class="m">500000</span>
</pre></div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="md_basics.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Molecular dynamics basics</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="lecture2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lecture 2</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Aditya Lele<br/>
  
      &copy; Copyright 2020.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>